/*
 * jQuery isocube v1.0
 * http://isocube.devel.bkahlert.com/
 *
 * Copyright 2011, Bj√∂rn kahlert
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 * 
 * Date: Mon Nov 7 02:01:15 2011 +0100
 *
 * Requires:
 *   jQuery 2d Transform v0.9.3
 *   http://wiki.github.com/heygrady/transform/
 *
 * Usage:
 *  $(selector).isocube([options]);
 *
 * Options:
 *   alpha: degree by which the top line of the top face of the cube is skewed
 *     0 makes the top face invisible
 *     45 makes the top face look like a square
 *     90 is invalid and would result in a rectangle with unlimited height
 *   shadow:
 *     true if a shadow should be casted
 */
(function(a){a.fn.isocube=function(b){function d(b){b.addClass("isocube");if(b.children(".face.right").length==0){b.append('<div class="face right"><div></div></div>')}if(b.children(".face.left").length==0){var d=a('<div class="face left"><div></div></div>');b.append(d);d.append(b.children().filter(":not(.face)"))}if(b.children(".face.top").length==0){b.append('<div class="face top"><div></div></div>')}if(c.shadow&&b.children(".shadow").length==0){b.append('<div class="shadow"><div></div></div>')}}if(this.css("position")!="absolute"&&this.css("position")!="relative")this.css({position:"relative"});var c={alpha:30,shadow:false};if(b)a.extend(c,b);return this.each(function(){var b=a(this);d(b);var e={alpha:b.attr("data-alpha"),shadow:b.attr("data-shadow")};var f=a.extend({},c,e);var g=b.width();var h=b.height();var i=f.alpha;var j=i*(Math.PI/180);var k=(45-i)*(Math.PI/180);var l=g/(Math.SQRT2*(Math.tan(k)+1));var m=(1/Math.SQRT2-.5)*l;var n=Math.SQRT2*.5*Math.tan(k)*l;var o=m+n;var p=m-n;var q=g*Math.tan(j);var r=q*.75;var s=g/2;var t=h-q;b.children(".face").css({position:"absolute"});b.children(".shadow").css({position:"absolute"});b.children(".face.top").css({top:p+"px",left:o+"px",width:l+"px",height:l+"px"}).transform({rotate:"45deg",skew:[i-45+"deg",i-45+"deg"]});b.children(".face.left").css({top:r+"px",left:"0px",width:s,height:t}).transform({skewY:i+"deg"});b.children(".face.right").css({top:r+"px",left:g/2+"px",width:s,height:t}).transform({skewY:-i+"deg"});if(f.shadow)b.children(".shadow").css({top:p+q*.5+t+"px",left:o-g/2+"px",width:l+"px",height:l+"px"}).transform({rotate:"45deg",skew:[i-45+"deg",i-45+"deg"]})})}})(jQuery)